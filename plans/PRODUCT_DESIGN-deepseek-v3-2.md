# nanobot 产品设计文档

## 产品概述
nanobot 是一款**超轻量级个人 AI 助手框架**，旨在为开发者、研究者和技术爱好者提供一个极简、可定制、易于理解的 AI 助手基础架构。与传统的庞大 AI 助手项目（如 Clawdbot 超过 43 万行代码）相比，nanobot 核心代理代码仅约 **4,000 行**，体积缩小了 **99%**，同时保留了核心的智能体循环、工具调用、多通道通信等关键能力。

## 问题陈述
1. **现有 AI 助手框架过于臃肿**：许多开源 AI 助手项目代码量巨大，学习曲线陡峭，难以快速上手和定制。
2. **研究和教学需求未被满足**：学术界和教学场景需要一个清晰、模块化、可插拔的 AI 助手实现，便于理解和二次开发。
3. **个人使用门槛高**：普通用户部署一个功能完整的个人 AI 助手需要配置复杂的环境和依赖，资源消耗大。
4. **多通道集成分散**：不同通信平台（Telegram、Discord、WhatsApp 等）的集成通常需要独立开发，缺乏统一框架。

## 目标用户
1. **AI 研究者**：需要轻量级、可读性强的代码进行实验和算法验证。
2. **开发者/工程师**：希望快速搭建个人 AI 助手，集成到自己的工作流中。
3. **教育机构/学生**：用于教学 AI 代理原理、工具调用、对话系统等课程内容。
4. **技术爱好者**：对 AI 助手感兴趣，希望拥有一个完全可控的个人助理。

## 核心价值主张
- **极简代码**：核心代理仅约 4,000 行 Python 代码，易于阅读、理解和修改。
- **研究友好**：清晰的模块边界和接口设计，便于进行学术研究和实验。
- **快速启动**：一键部署，几分钟内即可拥有一个功能完整的 AI 助手。
- **全栈能力**：支持文件操作、Shell 命令执行、网页搜索、消息发送等常用工具。
- **多通道支持**：无缝集成 Telegram、Discord、WhatsApp、飞书等主流通信平台。
- **本地模型兼容**：支持 vLLM 等本地 LLM 部署，保护隐私并降低使用成本。

## 核心功能模块

### 1. 智能体核心循环 (Agent Loop)
- **基于 LLM 的决策引擎**：接收用户输入，调用合适的工具，生成自然语言响应。
- **多轮对话管理**：维护会话历史，支持上下文连贯的长时间对话。
- **工具调用系统**：支持同步和异步工具执行，处理复杂任务链。

### 2. 工具生态系统
- **文件操作**：读取、写入、编辑文件，目录列表查看。
- **Shell 命令执行**：在安全沙箱中执行系统命令。
- **网页能力**：网页搜索（基于 Brave Search API）、网页内容抓取。
- **消息发送**：向通信渠道发送文本消息。
- **子代理生成**：创建后台任务执行复杂或长时间运行的操作。
- **定时任务**：基于 Cron 表达式的任务调度。

### 3. 内存系统
- **短期记忆**：每日笔记（按日期组织的 Markdown 文件）。
- **长期记忆**：持久化的 MEMORY.md 文件，存储重要用户信息和偏好。
- **记忆检索**：自动将相关记忆注入到对话上下文中。

### 4. 技能框架
- **可插拔技能**：模块化的技能系统，每个技能包含说明文档和执行逻辑。
- **内置技能**：GitHub 操作、天气查询、tmux 会话管理等开箱即用技能。
- **自定义技能**：用户可创建自己的技能，扩展助手能力。

### 5. 多通道网关
- **Telegram**：通过 Bot Token 快速集成，支持文本和语音消息转录。
- **Discord**：基于 Discord Bot API，支持服务器和个人消息。
- **WhatsApp**：通过 WhatsApp Web 协议，扫码即可连接。
- **飞书**：使用 WebSocket 长连接，无需公网 IP。
- **统一消息路由**：所有通道的消息通过统一总线路由到智能体。

### 6. 配置与部署
- **集中式配置**：`~/.nanobot/config.json` 管理所有设置。
- **多 LLM 提供商支持**：OpenRouter、Anthropic、OpenAI、DeepSeek、Groq、Gemini 等。
- **Docker 支持**：一键容器化部署，环境隔离。
- **安全沙箱**：可配置工作空间限制，防止越权文件访问。

## 用户场景

### 场景一：个人工作效率助手
- **用户**：软件工程师张三
- **需求**：在开发过程中快速查找文档、执行 Git 操作、管理本地服务器
- **使用方式**：
  1. 通过 Telegram 向 nanobot 发送消息："查看项目 logs 目录下的最新日志"
  2. nanobot 读取文件并返回关键信息
  3. "重启本地的 Redis 服务"
  4. nanobot 执行 shell 命令并返回结果

### 场景二：学术研究实验平台
- **用户**：AI 研究生李四
- **需求**：研究不同提示工程技术对工具调用准确率的影响
- **使用方式**：
  1. 克隆 nanobot 代码库，阅读清晰的模块结构
  2. 修改 `agent/context.py` 中的系统提示模板
  3. 运行实验脚本，收集不同提示下的工具调用数据
  4. 基于实验结果撰写论文

### 场景三：多平台个人助理
- **用户**：数字游民王五
- **需求**：在不同设备上通过不同应用使用同一个 AI 助手
- **使用方式**：
  1. 在手机 WhatsApp 中询问："今天北京的天气如何？"
  2. 在电脑 Discord 中请求："帮我总结今天的工作日志"
  3. 在飞书工作群中让助手："安排明天上午的团队会议"
  4. 所有对话共享同一记忆系统，体验一致

## 竞争优势分析

### 与大型 AI 助手框架对比
| 维度 | nanobot | 传统大型框架 (如 Clawdbot) |
|------|---------|----------------------------|
| 代码行数 | ~4,000 行 | 430,000+ 行 |
| 学习曲线 | 几小时 | 几周至几个月 |
| 定制难度 | 容易，模块清晰 | 困难，耦合度高 |
| 资源消耗 | 内存 < 100MB | 内存 > 1GB |
| 启动速度 | 秒级 | 分钟级 |

### 与商业 AI 助手对比
| 维度 | nanobot | 商业 AI 助手 (如 ChatGPT) |
|------|---------|----------------------------|
| 数据隐私 | 完全本地/自托管 | 数据上传至服务商 |
| 定制能力 | 完全开源，任意修改 | 有限定制，API 调用 |
| 成本 | 一次性部署，可选免费模型 | 按使用量付费 |
| 功能扩展 | 可添加任意自定义工具 | 受平台限制 |

## 产品路线图

### 短期 (1-3个月)
- [x] **核心代理框架**：基础循环、工具调用、会话管理
- [x] **多通道支持**：Telegram、Discord、WhatsApp、飞书
- [x] **内存系统**：每日笔记、长期记忆
- [x] **技能框架**：可插拔技能架构
- [ ] **语音转录增强**：支持更多语音服务提供商
- [ ] **可视化监控**：Web 仪表板查看助手状态

### 中期 (3-6个月)
- [ ] **多模态能力**：图像识别、语音合成
- [ ] **长期记忆优化**：向量数据库集成，智能记忆检索
- [ ] **推理能力增强**：多步规划、自我反思机制
- [ ] **更多集成**：Slack、电子邮件、日历服务
- [ ] **插件市场**：社区贡献技能分享平台

### 长期 (6-12个月)
- [ ] **自我改进**：从用户反馈中学习，优化行为
- [ ] **多代理协作**：多个 nanobot 实例协同工作
- [ ] **边缘设备部署**：在 Raspberry Pi 等设备上运行
- [ ] **企业版功能**：团队协作、权限管理、审计日志

## 成功指标
1. **采用率**：GitHub Stars 数量、PyPI 下载量
2. **社区活跃度**：贡献者数量、Issue 和 PR 响应时间
3. **用户满意度**：用户反馈评分、使用时长
4. **研究影响力**：学术论文引用次数、会议演讲
5. **生态扩展**：第三方技能数量、集成服务种类

## 风险与应对

### 技术风险
- **LLM API 依赖**：提供商服务不稳定或价格变动
  - *应对*：支持多提供商切换，加强本地模型支持
- **安全漏洞**：工具调用可能执行危险操作
  - *应对*：默认工作空间限制，用户可配置沙箱级别

### 市场风险
- **竞争加剧**：更多轻量级 AI 助手框架出现
  - *应对*：聚焦研究友好性和代码可读性，建立学术社区
- **需求变化**：AI 助手使用场景快速演变
  - *应对*：保持架构灵活，快速响应社区需求

### 运营风险
- **社区维护负担**：Issue 和 PR 数量增长过快
  - *应对*：建立贡献者指南，鼓励社区自治

## 总结
nanobot 填补了**极简 AI 助手框架**的市场空白，为研究者、开发者和爱好者提供了一个**易于理解、易于定制、易于部署**的个人 AI 助手解决方案。通过 99% 的代码精简，保留了核心智能体能力；通过模块化设计，支持灵活的功能扩展；通过多通道集成，满足用户在不同场景下的使用需求。

未来，nanobot 将继续坚持"轻量级、可读性、研究友好"的核心定位，发展成为 AI 代理领域的重要基础架构和教学研究平台。

---
*文档版本：v1.0*  
*最后更新：2026-02-08*  
*维护团队：nanobot contributors*